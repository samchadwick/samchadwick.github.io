<!doctype HTML>
<html>
<head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script>
        AFRAME.registerComponent('scene1end', {
            init: function () {
                this.el.addEventListener('animationcomplete', function () {
                    var scene2 = document.querySelector('#scene2');
                    console.log("Start Scene 2");
                    scene2.emit('start');
                    [].slice.call(scene2.children).forEach(child => {
                        child.emit("start");
                    });
                });
            }
        });
        AFRAME.registerComponent('scene2end', {
            init: function () {
                var scene2 = document.querySelector('#scene2');
                this.el.addEventListener('animationcomplete', function () {
                    var scene3 = document.querySelector('#scene3');
                    console.log("Start Scene 3");
                    scene2.emit('end');
                    [].slice.call(scene2.children).forEach(child => {
                        child.emit("end");
                    });
                    scene3.emit('start');
                    [].slice.call(scene3.children).forEach(child => {
                        child.emit("start");
                    });
                });
            }
        });
        AFRAME.registerComponent('scene3end', {
            init: function () {
                var scene3 = document.querySelector('#scene3');
                this.el.addEventListener('animationcomplete', function () {
                    var scene4 = document.querySelector('#scene4');
                    console.log("Start Scene 4");
                    scene3.emit('end');
                    [].slice.call(scene3.children).forEach(child => {
                        child.emit("end");
                    });
                    scene4.emit('start');
                    [].slice.call(scene4.children).forEach(child => {
                        child.emit("start");
                    });
                });
            }
        });
        AFRAME.registerComponent('group-opacity', {
            schema: {opacity: {default: 1.0}},
            update: function () {
                var opacity = this.data.opacity;
                var children = [].slice.call(this.el.children);
                children
                    .filter(function (child) {
                        return child.hasAttribute('material') || child.hasAttribute('group-opacity');
                    })
                    .forEach(function (child) {
                        child.setAttribute('material', "opacity: " + opacity);
                        child.setAttribute('group-opacity', "opacity: " + opacity);
                    });
                children
                    .filter(function (child) {
                        return child.hasAttribute('value');
                    })
                    .forEach(function (child) {
                        child.setAttribute('opacity', opacity);
                    });
            }
        });
    </script>
</head>
<body>
<a-scene>

    <a-assets>
        <a-asset-item id="threekeys-obj" src="/academy-room/assets/threekeys.obj"></a-asset-item>
        <a-asset-item id="threekeys-mtl" src="/academy-room/assets/threekeys.mtl"></a-asset-item>
        <audio id="sound" src="/academy-room/assets/intro_movie.mp3"></audio>
    </a-assets>
    <!-- Mobile browsers block autoplay.  Needs to be triggered by a gesture. -->
    <a-sound src="#sound" autoplay></a-sound>
    <a-sky color="#FFFFFF"></a-sky>
    <!-- Need to find a way to turn off the camera rotation is the user is wearing a headset -->
    <a-entity id="rig" position="0 1.6 0"
        animation="property: rotation; to: 0 -90 0; delay: 4000; dur: 4000;"
        animation__2="property: rotation; from: 0 -90 0; to: 0 -180 0; delay: 10000; dur: 4000;"
        animation__3="property: rotation; from: 0 -180 0; to: 0 -270 0; delay: 18000; dur: 4000;">
        <a-entity id="camera" camera look-controls></a-entity>

    </a-entity>
    

    <!-- Scene 1-->
    <a-entity id="scene1" group-opacity="opacity: 1.0"
              animation="property: group-opacity.opacity; from: 1; to: 0.9; delay: 5500;">

        <a-box color="grey" position="0.2 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: -2 3 -5; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000;"></a-box> 
        <a-box color="grey" position="0.2 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: -3 1 -3; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000;"></a-box> 
        <a-box color="grey" position="0.2 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: -1 1 -4; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000;"></a-box> 
        <a-box color="grey" position="3.2 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 2 1.2 -3.5; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000;"></a-box> 
        <a-box color="grey" position="2.8 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 1 1 -1.5; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000;"></a-box> 
        <a-box color="grey" position="2.6 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: -1 0.8 -12; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000;"></a-box> 
        <a-box color="grey" position="2.4 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 2 3 -2; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000;"></a-box> 
        <a-box material="color: black; opacity: 1; wireframe: true" position="0.3 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 2 4 -4; dur: 3000; delay: 500"></a-box>
        <a-box material="color: black; opacity: 1; wireframe: true" position="0.3 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: -1.5 2 -2; dur: 3000; delay: 500"></a-box>

        <a-text color="black" position="0.2 1.5 1" scale="1 1 1" value="The"
                animation__show="property: position; to: -2 2 -4; dur: 3000; delay: 100"></a-text>
        <a-text color="black" position="0.4 1.5 1" scale="1 1 1" value="world"
                animation="property: position; to: -1.55 2 -4; dur: 3000; delay: 300"></a-text>
        <a-text color="black" position="0.6 1.5 1" scale="1 1 1" value="looks"
                animation="property: position; to: -0.95 2 -4; dur: 3000; delay: 500"></a-text>
        <a-text color="black" position="0.7 1.5 1" scale="1 1 1" value="different"
                animation="property: position; to: -0.35 2 -4; dur: 3000; delay: 700"></a-text>
        <a-text color="black" position="0.9 1.5 1" scale="1 1 1" value="when"
                animation="property: position; to: 0.55 2 -4; dur: 3000; delay: 800"></a-text>

        <a-text color="black" position="0.2 1.3 1" scale="1 1 1" value="you"
                animation="property: position; to: -1.9 1.7 -4; dur: 3000; delay: 500"></a-text>
        <a-text color="black" position="0.4 1.3 1" scale="1 1 1" value="take"
                animation="property: position; to: -1.5 1.7 -4; dur: 3000; delay: 700"></a-text>
        <a-text color="black" position="0.7 1.3 1" scale="1 1 1" value="a"
                animation="property: position; to: -1.0 1.7 -4; dur: 3000; delay: 800"></a-text>
        <a-text color="black" position="0.8 1.3 1" scale="1 1 1" value="fresh"
                animation="property: position; to: -0.8 1.7 -4; dur: 3000; delay: 900;"
                animation__color="property: text.color; from: #000000; to: #FF0000; delay: 2500; dur: 2000;"></a-text>
        <a-text color="black" position="0.9 1.3 1" scale="1 1 1" value="perspective"
                animation="property: position; to: -0.22 1.7 -4; dur: 3000; delay: 1000;"
                animation__color="property: text.color; from: #000000; to: #FF0000; delay: 2500; dur: 2000;" scene1end></a-text>
    </a-entity>

    <!-- Scene 2 -->
    <a-entity id="scene2" group-opacity="opacity: 0"
              animation__start="property: group-opacity.opacity; from: 0; to: 1; startEvents: start;"
              animation__end="property: group-opacity.opacity; from: 1; to: 0.9; delay: 3000; startEvents: end;">

        <a-box color="grey" position="-2.2 1 -3" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 3 1.2 -2; dur: 2500; startEvents: start;" easing="easeInOutQuad"></a-box>
        <a-box color="grey" position="-2.2 1 -2" rotation="0 0 0" scale="0.3 0.3 0.3"
               animation="property: position; to: 4 1.2 -1; dur: 3000; delay: 500; startEvents: start;" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000; startEvents: start;" scene2end></a-box> 
        <a-box material="color: black; opacity: 1; wireframe: true" position="-2.2 1 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 2 1 1; dur: 3000; delay: 200; startEvents: start;"></a-box>

        <a-text color="black" position="-2.2 1.5 -2" scale="1 1 1" rotation="0 -90 0" value="It"
                animation="property: position; to: 5 2 -1.8; dur: 3000; delay: 400; startEvents: start;"></a-text>
        <a-text color="black" position="-1.8 1.5 -1" scale="1 1 1" rotation="0 -90 0" value="can"
                animation="property: position; to: 5 2 -1.6; dur: 3000; delay: 300; startEvents: start;"></a-text>
        <a-text color="black" position="-2.1 1.5 0" scale="1 1 1" rotation="0 -90 0" value="highlight"
                animation="property: position; to: 5 2 -1.2; dur: 3000; delay: 500; startEvents: start;"></a-text>
        <a-text color="red" position="-2.3 1.5 1.5" scale="1 1 1" rotation="0 -90 0" value="new"
                animation="property: position; to: 5 2 -0.3; dur: 3000; delay: 700; startEvents: start;"></a-text>
        <a-text color="black" position="-2.4 1.5 2" scale="1 1 1" rotation="0 -90 0" value="opportunities"
                animation="property: position; to: 5 2 0.15; dur: 3000; delay: 800; startEvents: start;"></a-text>
    </a-entity>

    <!-- Scene 3 -->
    <a-entity id="scene3" group-opacity="opacity: 0"
              animation__start3="property: group-opacity.opacity; from: 0; to: 1; startEvents: start;"
              animation__end3="property: group-opacity.opacity; from: 1; to: 0.9; delay: 3000; startEvents: end;">

        <a-box color="grey" position="-0.2 1 -1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 2 1.2 2; dur: 3000; delay: 800; startEvents: start;" easing="easeInOutQuad"></a-box>
        <a-box color="grey" position="-0.2 1 -1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 5 1.2 3; dur: 3000; delay: 600; startEvents: start;" easing="easeInOutQuad"></a-box>
        <a-box material="color: black; opacity: 0; wireframe: true" position="-2 3 3" rotation="0 0 0" scale="1 1 1"
               animation="property: components.material.material.opacity; from: 0; to: 1; dur: 3000; delay: 5000; startEvents: start;" easing="easeInOutQuad"></a-box>
        <a-box color="grey" position="-0.2 1 -1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 5 1.2 -2; dur: 3000; delay: 600; startEvents: start;" easing="easeInOutQuad"></a-box>

        <a-box color="grey" position="0.2 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 2 3 4; delay: 3000; dur: 3000; startEvents: start;" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 4000; dur: 2000; startEvents: start;"></a-box> 
        <a-box color="grey" position="0.2 1.5 1" rotation="0 0 0" scale="0.3 0.3 0.3"
               animation="property: position; to: 3 4 5; delay: 3000; dur: 3000; startEvents: start;" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 4000; dur: 2000; startEvents: start;"></a-box> 
        <a-box color="grey" position="0.2 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 1 1 4; delay: 3000; dur: 3000; startEvents: start;" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 4000; dur: 2000; startEvents: start;"></a-box> 
        <a-box color="grey" position="2 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: 2 1.2 3.5; delay: 3000; dur: 3000; startEvents: start;" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 4000; dur: 2000; startEvents: start;"></a-box> 
        <a-box color="grey" position="-2.8 1.5 1" rotation="0 0 0" scale="0.4 0.4 0.4"
               animation="property: position; to: -2 1 4; delay: 3000; dur: 3000; startEvents: start;" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 4000; dur: 2000; startEvents: start;"></a-box> 
        <a-box color="grey" position="-2.6 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: -1 0.8 4.5; delay: 3000; dur: 3000; startEvents: start; " easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 4000; dur: 2000; startEvents: start;"></a-box> 
        <a-box color="grey" position="-2.4 1.5 1" rotation="0 0 0" scale="0.2 0.2 0.2"
               animation="property: position; to: -3 0 4; delay: 3000; dur: 3000" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 4000; dur: 2000; startEvents: start;"></a-box> 

        <a-box color="grey" position="-0.2 1 -1" rotation="0 0 0" scale="0.4 0.4 0.4"
               animation="property: position; to: 4 1.2 1; dur: 3000; delay: 100; startEvents: start;" easing="easeInOutQuad"
               animation__color="property: material.color; from: #808080; to: #FF0000; delay: 2000; dur: 2000; startEvents: start;" scene3end></a-box> 

        <a-text color="black" position="-2.2 1.5 -2" scale="1 1 1" rotation="0 180 0" value="And"
                animation="property: position; to: 1.85 1.7 4; dur: 3000; delay: 400; startEvents: start;"></a-text>
        <a-text color="black" position="-1.8 1.5 -1" scale="1 1 1" rotation="0 180 0" value="reveal"
                animation="property: position; to: 1.4 1.7 4; dur: 3000; delay: 300; startEvents: start;"></a-text>
        <a-text color="red" position="-2.1 1.5 0" scale="1 1 1" rotation="0 180 0" value="hidden"
                animation="property: position; to: 0.75 1.7 4; dur: 3000; delay: 500; startEvents: start;"></a-text>
        <a-text color="black" position="-2.4 1.5 2" scale="1 1 1" rotation="0 180 0" value="obstacles"
                animation="property: position; to: 0.05 1.7 4; dur: 3000; delay: 800; startEvents: start;"></a-text>

    </a-entity>

    <!-- Scene 4 -->
    <a-entity id="scene4" group-opacity="opacity: 0"
              animation__start4="property: group-opacity.opacity; from: 0; to: 1; startEvents: start;"
              animation__end4="property: group-opacity.opacity; from: 1; to: 0.9; delay: 8000; startEvents: end;">

        <a-entity id="logo" obj-model="obj:#threekeys-obj; mtl:#threekeys-mtl"
                  scale="0.01 0.01 0.01" position="-10 100 0" rotation="90 0 90"
                  light="type:directional; castShadow:true;" shadow="receive: true"
                  animation="property: position; to: -10 1.6 0; dur: 2000; delay: 8000; startEvents: start;"
                  animation__2="property: rotation; to: 90 540 90; dur: 10000; delay: 10000; startEvents: start;"></a-entity>

        <a-text color="black" position="4 1.6 1" scale="0.5 0.5 0.5" rotation="0 90 0" value="At UBS Research Academy"
                animation="property: position; to: -3 1.6 2.2; dur: 3000; delay: 8000; startEvents: start;"
                ></a-text>
        <a-text color="black" position="4 1.2 0.9" scale="0.7 0.7 0.7" rotation="0 90 0" value="our"
                animation="property: position; to: -3 1.35 2.35; dur: 3000; delay: 9500; startEvents: start;"
                ></a-text>
        <a-text color="red" position="4 1.2 0.7" scale="0.7 0.7 0.7" rotation="0 90 0" value="#1"
                animation="property: position; to: -3 1.35 2.1; dur: 3000; delay: 9750; startEvents: start;"
                ></a-text>
        <a-text color="black" position="4 1.2 0.5" scale="0.7 0.7 0.7" rotation="0 90 0" value="rated analysts"
                animation="property: position; to: -3 1.35 1.9; dur: 3000; delay: 10000; startEvents: start;"
                ></a-text>

        <a-text color="black" position="4 1.6 -0.5" scale="0.5 0.5 0.5" rotation="0 90 0" value="deliver programmes"
                animation="property: position; to: -3 1.6 -0.9; dur: 3000; delay: 12000; startEvents: start;"
                ></a-text>
        <a-text color="black" position="4 1.2 -0.7" scale="0.5 0.5 0.5" rotation="0 90 0" value="that provide the tools\n techniques and insights"
                animation="property: position; to: -3 1.35 -0.9; dur: 3000; delay: 13000; startEvents: start;"
                ></a-text>

        <a-text color="black" position="4 1 1" scale="1 1 1" rotation="0 90 0" value="to uncover these new perspectives"
                animation="property: position; to: -3.75 0 2.3; dur: 3000; delay: 14000; startEvents: start;"
                ></a-text>
        <a-text color="black" position="4 1 -0.7" scale="1 1 1" rotation="0 90 0" value="and"
                animation="property: position; to: -3.0 0 1.2; dur: 3000; delay: 15000; startEvents: start;"
                ></a-text>
        <a-text color="red" position="4 1 -0.7" scale="1 1 1" rotation="0 90 0" value="sharpen"
                animation="property: position; to: -3.0 0 0.8; dur: 3000; delay: 15500; startEvents: start;"
                ></a-text>
        <a-text color="black" position="4 1 -0.7" scale="1 1 1" rotation="0 90 0" value="your investment edge"
                animation="property: position; to: -3.0 0 -0.05; dur: 3000; delay: 16000; startEvents: start;"
                ></a-text>
    </a-entity>


</a-scene>
</body>
</html>
